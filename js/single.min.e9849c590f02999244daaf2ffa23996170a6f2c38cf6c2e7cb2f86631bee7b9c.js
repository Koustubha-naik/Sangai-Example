document.addEventListener("DOMContentLoaded",()=>{const n=document.querySelector(".toc-sidebar"),s=document.querySelector(".toc-title");n&&s&&s.addEventListener("click",()=>{n.classList.toggle("closed")}),document.querySelectorAll(".toc-content a").forEach(e=>{const t=e.getAttribute("href");if(!t||!t.startsWith("#"))return;e.addEventListener("click",e=>{e.preventDefault();const n=document.querySelector(t);if(!n)return;window.scrollTo({top:n.offsetTop-40,behavior:"smooth"})})});const i=Array.from(document.querySelectorAll("h1, h2, h3, h4, h5")).filter(e=>e.id),a=document.querySelectorAll(".toc-content a"),r=e=>{a.forEach(t=>{t.classList.toggle("active",t.getAttribute("href")===`#${e}`)})},c=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&r(e.target.id)})},{rootMargin:"-40% 0px -50% 0px",threshold:0});i.forEach(e=>c.observe(e));const l=document.querySelectorAll(".single-content video, .single-content iframe");l.forEach(e=>{e.addEventListener("fullscreenchange",()=>{if(!document.fullscreenElement){screen.orientation.unlock&&screen.orientation.unlock();return}const t=e.videoWidth||16,n=e.videoHeight||9,s=t/n;s>1.2&&screen.orientation.lock&&screen.orientation.lock("landscape").catch(()=>{})})});const e=document.querySelector(".lightbox"),t=document.querySelector(".lb-image"),o=document.querySelector(".lb-close");if(e&&t&&o){document.querySelectorAll("[data-zoom] img").forEach(n=>{n.addEventListener("click",()=>{t.src=n.src,t.alt=n.alt||"",e.hidden=!1,document.body.style.overflow="hidden"})});const n=()=>{e.hidden=!0,t.src="",document.body.style.overflow=""};o.addEventListener("click",n),e.addEventListener("click",t=>{t.target===e&&n()}),document.addEventListener("keydown",t=>{t.key==="Escape"&&!e.hidden&&n()})}})